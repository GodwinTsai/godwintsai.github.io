{"title":"ps脚本解析psd文本字号","uid":"3e1482db617d1778a858877ea039d577","slug":"ps脚本解析psd文本字号","date":"2018-08-25T06:59:52.000Z","updated":"2022-07-16T11:30:57.119Z","comments":true,"path":"api/articles/ps脚本解析psd文本字号.json","keywords":null,"cover":null,"content":"<span id=\"more\"></span>\n\n<p>ps脚本解析psd中文本字号最简单的方法，通过DOM获取：var size &#x3D; activeDocument.activeLayer.textItem.size;  </p>\n<p>但是当该文本被拉伸过后，DOM解析出来的字号就会错误。正确的方式是通过Action Manager来获取：</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">function getTextSize()&#123;  \n    var ref &#x3D; new ActionReference();  \n    ref.putEnumerated( charIDToTypeID(&quot;Lyr &quot;), charIDToTypeID(&quot;Ordn&quot;), charIDToTypeID(&quot;Trgt&quot;) );   \n    var desc &#x3D; executeActionGet(ref).getObjectValue(stringIDToTypeID(&#39;textKey&#39;));  \n    var textSize &#x3D;  desc.getList(stringIDToTypeID(&#39;textStyleRange&#39;)).getObjectValue(0).getObjectValue(stringIDToTypeID(&#39;textStyle&#39;)).getDouble (stringIDToTypeID(&#39;size&#39;));  \n    if (desc.hasKey(stringIDToTypeID(&#39;transform&#39;))) \n    &#123;  \n            var mFactor &#x3D; desc.getObjectValue(stringIDToTypeID(&#39;transform&#39;)).getUnitDoubleValue (stringIDToTypeID(&quot;yy&quot;) );  \n            textSize &#x3D; (textSize* mFactor).toFixed(0);  \n    &#125;  \n    return textSize;  \n&#125; </code></pre>","text":" ps脚本解析psd中文本字号最简单的方法，通过DOM获取：var size &#x3D; activeDocument.activeLayer.textItem.size; 但是当该文本被拉伸过后，DOM解析出来的字号就会错误。正确的方式是通过Action Manager来获取...","link":"","photos":[],"count_time":{"symbolsCount":976,"symbolsTime":"1 mins."},"categories":[{"name":"PhotoShop","slug":"PhotoShop","count":2,"path":"api/categories/PhotoShop.json"}],"tags":[],"toc":"","author":{"name":"GodwinTsai","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"https://github.com/GodwinTsai","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Timeline 一，简介","uid":"077ece2c7670b51ed3e04645fca4119e","slug":"Timeline 一，简介","date":"2019-08-12T12:00:51.000Z","updated":"2022-07-16T11:30:57.117Z","comments":true,"path":"api/articles/Timeline 一，简介.json","keywords":null,"cover":[],"text":" 尊重原创，转载请在文首注明出处：https://blog.csdn.net/cai612781/article/details/99330696 环境： Unity 2018.4 一，Introduction 1.1,Timeline Timeline是Unity2017新增的...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"Timeline","slug":"Timeline","count":2,"path":"api/categories/Timeline.json"}],"tags":[{"name":"Timeline","slug":"Timeline","count":1,"path":"api/tags/Timeline.json"}],"author":{"name":"GodwinTsai","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"https://github.com/GodwinTsai","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"C#调用可执行文件","uid":"352e398b9e08d481e8318632bbc69c42","slug":"CSharp调用可执行文件","date":"2018-01-11T01:50:59.000Z","updated":"2022-07-16T11:30:57.116Z","comments":true,"path":"api/articles/CSharp调用可执行文件.json","keywords":null,"cover":null,"text":" 尊重原创，转载请在文首注明出处：http://blog.csdn.net/cai612781/article/details/79030654 一，语法 C#提供Process类来对本地或远程进程进行访问，以及启动或停止本地进程。 更多语法信息：https://msdn.mic...","link":"","photos":[],"count_time":{"symbolsCount":"1.8k","symbolsTime":"2 mins."},"categories":[{"name":"C#","slug":"C","count":4,"path":"api/categories/C.json"}],"tags":[{"name":"C#启动进程 C#调用可执行文件","slug":"C-启动进程-C-调用可执行文件","count":1,"path":"api/tags/C-启动进程-C-调用可执行文件.json"}],"author":{"name":"GodwinTsai","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"https://github.com/GodwinTsai","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}