{"title":"C#复制文件","uid":"753f4a58196ae7671f17e65f13baa6b7","slug":"CSharp复制文件","date":"2018-01-09T09:22:12.000Z","updated":"2022-07-16T11:30:57.115Z","comments":true,"path":"api/articles/CSharp复制文件.json","keywords":null,"cover":null,"content":"<span id=\"more\"></span>\n\n<p>尊重原创，转载请在文首注明出处：<a href=\"http://blog.csdn.net/cai612781/article/details/79015286\">http://blog.csdn.net/cai612781/article/details/79015286</a></p>\n<p>开发Unity编辑器工具中经常遇到需要把文件复制到工程中，例如数据、图片等。</p>\n<pre class=\"line-numbers language-csharp\" data-language=\"csharp\"><code class=\"language-csharp\">using System.Collections.Generic;\nusing System.IO;\n\nnamespace Assets.Editor\n&#123;\n\tclass FileUtil\n\t&#123;\n\t\t&#x2F;&#x2F;比较两个文件夹，获得改动的文件\n\t\tpublic static FileInfo[] GetNeedCopyFiles(string srcPath, string desPath, bool forceCopy &#x3D; false)\n\t\t&#123;\n\t\t\tFileInfo[] files &#x3D; &#123;&#125;;\n\t\t\tList&lt;FileInfo&gt; fileInfoList &#x3D; new List&lt;FileInfo&gt;();\n\t\t\tDirectoryInfo srcDirInfo &#x3D; new DirectoryInfo(srcPath);\n\t\t\tDirectoryInfo desDirInfo &#x3D; new DirectoryInfo(desPath);\n\t\t\tif(!srcDirInfo.Exists)\n\t\t\t&#123;\n\t\t\t\treturn files;\n\t\t\t&#125;\n\t\t\tif(!desDirInfo.Exists)\n\t\t\t&#123;\n\t\t\t\tDirectory.CreateDirectory(desPath);\n\t\t\t&#125;\n\t\t\tFileInfo[] fileArr &#x3D; srcDirInfo.GetFiles();\n\t\t\tfor(int i &#x3D; 0, len &#x3D; fileArr.Length; i &lt; len; i++)\n\t\t\t&#123;\n\t\t\t\tstring filePath &#x3D; desDirInfo.FullName + &quot;\\\\&quot; + fileArr[i].Name;\n\t\t\t\tFileInfo fileInfo &#x3D; new FileInfo(filePath);\n\t\t\t\tif(!fileInfo.Exists)\n\t\t\t\t&#123;\n\t\t\t\t\tfileInfoList.Add(fileArr[i]);\n\t\t\t\t\tcontinue;\n\t\t\t\t&#125;\n\t\t\t\tif(forceCopy || fileArr[i].Length !&#x3D; fileInfo.Length)\n\t\t\t\t&#123;\n\t\t\t\t\tfileInfoList.Add(fileArr[i]);\n\t\t\t\t&#125;\n\t\t\t&#125;\n\t\t\tfiles &#x3D; fileInfoList.ToArray();\n\t\t\treturn files;\n\t\t&#125;\n\t\t\n\t\t&#x2F;&#x2F;拷贝文件到目标路径\n\t\tpublic static void CopyFiles(ileInfo[] infos, string desPath)\n\t\t&#123;\n\t\t\tstring desFileName;\n\t\t\tFileInfo file;\n\t\t\tfor(int i &#x3D; 0, len &#x3D; infos.Length; i &lt; len; i++)\n\t\t\t&#123;\n\t\t\t\tfile &#x3D; infos[i];\n\t\t\t\tdesFileName &#x3D; Path.Combine(desPath, file.Name);\n\t\t\t\tif(File.Exists(desFileName))\n\t\t\t\t&#123;\n\t\t\t\t\tnew FileInfo(desFileName).IsReadOnly &#x3D; false;&#x2F;&#x2F;注1\n\t\t\t\t&#125;\n\t\t\t\tfile.CopyTo(desFileName, true);\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;\n&#125;</code></pre>\n\n<p>注1：</p>\n<p>当删除文件或者复制文件时选择覆盖，如果该文件是个只读文件，则会抛出异常：System.UnauthorizedAccessException。</p>\n<p>解决方法是：</p>\n<p>new FileInfo(filePath).IsReadOnly &#x3D; false;</p>\n<p>或者：</p>\n<p>new FileInfo(filePath).Attributes &#x3D; FileAttributes.Normal;</p>\n","text":" 尊重原创，转载请在文首注明出处：http://blog.csdn.net/cai612781/article/details/79015286 开发Unity编辑器工具中经常遇到需要把文件复制到工程中，例如数据、图片等。 using System.Collections.Gen...","link":"","photos":[],"count_time":{"symbolsCount":"2k","symbolsTime":"2 mins."},"categories":[{"name":"C#","slug":"C","count":4,"path":"api/categories/C.json"}],"tags":[{"name":"C#复制文件 删除只读文件异常","slug":"C-复制文件-删除只读文件异常","count":1,"path":"api/tags/C-复制文件-删除只读文件异常.json"}],"toc":"","author":{"name":"GodwinTsai","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"https://github.com/GodwinTsai","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"C#调用可执行文件","uid":"352e398b9e08d481e8318632bbc69c42","slug":"CSharp调用可执行文件","date":"2018-01-11T01:50:59.000Z","updated":"2022-07-16T11:30:57.116Z","comments":true,"path":"api/articles/CSharp调用可执行文件.json","keywords":null,"cover":null,"text":" 尊重原创，转载请在文首注明出处：http://blog.csdn.net/cai612781/article/details/79030654 一，语法 C#提供Process类来对本地或远程进程进行访问，以及启动或停止本地进程。 更多语法信息：https://msdn.mic...","link":"","photos":[],"count_time":{"symbolsCount":"1.8k","symbolsTime":"2 mins."},"categories":[{"name":"C#","slug":"C","count":4,"path":"api/categories/C.json"}],"tags":[{"name":"C#启动进程 C#调用可执行文件","slug":"C-启动进程-C-调用可执行文件","count":1,"path":"api/tags/C-启动进程-C-调用可执行文件.json"}],"author":{"name":"GodwinTsai","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"https://github.com/GodwinTsai","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"C#调用SVN","uid":"46fb15b5cb654d863634ab785c7560a1","slug":"CSharp调用SVN","date":"2018-01-09T09:10:37.000Z","updated":"2022-07-16T14:45:06.484Z","comments":true,"path":"api/articles/CSharp调用SVN.json","keywords":null,"cover":null,"text":" 尊重原创，转载请在文首注明出处：http://blog.csdn.net/cai612781/article/details/79015085 一，语法 项目开发中通常都会使用Subversion(SVN)作为版本控制系统，同时会使用SVN的客户端软件TortoiseSVN。 ...","link":"","photos":[],"count_time":{"symbolsCount":"3.6k","symbolsTime":"3 mins."},"categories":[{"name":"C#","slug":"C","count":4,"path":"api/categories/C.json"}],"tags":[{"name":"C#调用SVN","slug":"C-调用SVN","count":1,"path":"api/tags/C-调用SVN.json"}],"author":{"name":"GodwinTsai","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"https://github.com/GodwinTsai","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}